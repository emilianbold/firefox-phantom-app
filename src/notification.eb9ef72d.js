(function(define){var __define;"function"==typeof define&&define.amd&&(__define=define,define=null);function e(e){return e&&e.__esModule?e.default:e}function t(e,t,n,a){Object.defineProperty(e,t,{get:n,set:a,enumerable:!0,configurable:!0})}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},o={},r=n.parcelRequirea886;null==r&&((r=function(e){if(e in a)return a[e].exports;if(e in o){var t=o[e];delete o[e];var n={id:e,exports:{}};return a[e]=n,t.call(n.exports,n,n.exports),n.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){o[e]=t},n.parcelRequirea886=r);var i=r("aZikt"),s=r("ihAua"),c=r("eLyRJ"),l=r("HEK4k"),u=r("ci2Mj"),d=r("8C6BZ"),p=r("5cKs6"),m=r("iyOkC"),g=r("4yWCU");r("6CHoY");var f={};t(f,"BackgroundConnectionProvider",(function(){return A}),(function(e){return A=e})),t(f,"useIncomingBackgroundRequest",(function(){return x}),(function(e){return x=e})),t(f,"usePostOutgoingBackgroundResponse",(function(){return k}),(function(e){return k=e}));i=r("aZikt");var v=r("e5x4G"),y=r("6oEu9"),h=(m=r("iyOkC"),function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((a=a.apply(e,t||[])).next())}))});const T={isConnected:!1,lastMessage:null,postMessage:y.NOOP},E=e(i).createContext(T),A=({children:t})=>{const[n,a,o]=function(){const[e,t]=i.useState(null),[n,a]=i.useState(null);i.useEffect((()=>{let e;return(()=>h(this,void 0,void 0,(function*(){const n=`notification/${(yield m.getCurrentWindowAsync()).id}`;e=v.browser.runtime.connect({name:n}),t(e),e.onMessage.addListener((e=>{a(e)})),e.onDisconnect.addListener((()=>{t(null)}))})))(),()=>{null==e||e.disconnect()}}),[]);const o=i.useCallback((t=>{e&&e.postMessage(t)}),[e]);return[!!e,n,o]}();return e(i).createElement(E.Provider,{value:{isConnected:n,lastMessage:a,postMessage:o}},t)};function b(){const e=i.useContext(E);if(!e)throw new Error("Missing background connection context");return e}function x(){const{lastMessage:e}=b();return e&&"string"==typeof e.origin&&e.origin&&e.req&&"string"==typeof e.req.method&&e.req.method?e:null}function k(){const e=x(),{postMessage:t}=b();return i.useCallback((n=>{if(!e)throw new Error("No request received from the background yet");if(e.req.id!==n.id)throw new Error(`Request id: ${e.req.id} does not match response id: ${n.id}`);t(n)}),[e,t])}var S=r("6rMcH"),w=r("eduP0"),C=r("ixd3d"),M=r("82Ilk"),P=r("9ZliH"),R=r("5DQqc"),I=r("eeuNW"),B=r("g9lcT"),O=r("h5G75"),F=r("6mzlH"),q=r("jSC0s"),H=r("cjUNA"),D=(i=r("aZikt"),r("hHMPk")),L=(d=r("8C6BZ"),r("lwple")),N=(c=r("eLyRJ"),M=r("82Ilk"),i=r("aZikt"),D=r("hHMPk"),r("7Qmuu")),j=r("cFuyE"),W=r("hJDxl"),K=r("bJYWD"),z=r("9AO5f"),U=r("aADTv"),$=r("lSpdH"),Q=r("g7X40");const Z=D.default.div`
  border-top: 1px solid #333333;
  border-bottom: 1px solid #333333;
  width: 100%;
  display: flex;
  padding: 10px 5px;
`,_=D.default.div`
  > * {
    margin: 18px 0px;
  }
`,J=D.default.div`
  display: flex;
  flex-direction: row;
  align-items: center;
  > * {
    margin: 0px ${e=>e.spacing}px;
    text-align: left;
  }
`,V=({tabId:t,origin:n,confirmApproval:a,denyApproval:o})=>{const{t:r}=N.useTranslation();return e(i).createElement(K.Container,null,e(i).createElement(z.AccountHeader,{lastChild:e(i).createElement("div",null),walletMenuShowOnlyAccounts:!0}),e(i).createElement(K.Body,null,e(i).createElement(K.TopGroup,null,e(i).createElement($.TabIconHeader,{tabId:t,secondaryText:j.removeWebPrefixes(n)})),e(i).createElement(Z,null,e(i).createElement(_,null,e(i).createElement(J,{spacing:8},e(i).createElement(Q.Text,{size:14,color:"#777777",lineHeight:16.94,weight:500},r("notificationApplicationApprovalPermissionsPrimary"))),e(i).createElement(J,{spacing:8},e(i).createElement(W.CheckmarkIcon,{fill:"#21E56F"}),e(i).createElement(Q.Text,{size:14,lineHeight:17},r("notificationApplicationApprovalPermissionsViewWalletActivity"))),e(i).createElement(J,{spacing:8},e(i).createElement(W.CheckmarkIcon,{fill:"#21E56F"}),e(i).createElement(Q.Text,{size:14,lineHeight:17},r("notificationApplicationApprovalPermissionsTransactionApproval"))))),e(i).createElement(K.BottomGroup,null,e(i).createElement(J,{spacing:4},e(i).createElement(Q.Text,{size:14,lineHeight:17,color:"#777"},r("notificationApplicationApprovalConnectDisclaimer"))))),e(i).createElement(K.Footer,{plain:!0},e(i).createElement(U.ButtonPair,{primaryText:r("notificationApplicationApprovalActionButtonConnect"),secondaryText:r("notificationApplicationApprovalActionButtonCancel"),onPrimaryClicked:()=>a(n),onSecondaryClicked:()=>o(n)})))};var G=r("6oQjh"),Y=r("iO2dB"),X=r("9OxTN"),ee=r("lPkGw");const te=D.default.div`
  display: flex;
  flex-direction: column;
  height: 100%;
  justify-content: center;
  align-items: center;
`,ne=({tabId:t,origin:n,requestId:a})=>{var o;const{accountClient:r}=M.useSelectedAccount(),s=r.publicKey.toString(),l=f.usePostOutgoingBackgroundResponse(),[u,p,m]=G.useStorage(L.StorageKeys.TrustedApplicationsByOwnerBrowser,{}),g=null!==(o=u[s])&&void 0!==o?o:{},v=void 0!==g[n],[y,h]=e(i).useState(!1),[T,E]=e(i).useState(!1),A=t=>{const n=e(H)(g);n[t]=!0,d.analytics.capture("connectionConfirm",{data:{origin:t}}),m(Object.assign(Object.assign({},u),{[s]:n}))},b=()=>{d.analytics.capture("connectionDeny",{data:{origin:n}});const e=c.createJsonRpcErrorResponse(a,c.RpcErrorCode.UserRejectedRequest);l(e)};if(i.useEffect((()=>{v?(()=>{const e={publicKey:s},t=c.createJsonRpcResponse(a,e);l(t)})():X.detectPhishing(n).then((e=>{E(e.result),h(!0)})).catch((()=>{h(!0)}))}),[v]),v)return null;return p||!y?e(i).createElement(te,null,e(i).createElement(ee.Spinner,null)):T?e(i).createElement(Y.BlocklistConnectRequest,{tabId:t,origin:n,confirmApproval:A,denyApproval:b}):e(i).createElement(V,{tabId:t,origin:n,confirmApproval:A,denyApproval:b})};var ae={};t(ae,"SignatureRequest",(function(){return ht}),(function(e){return ht=e}));i=r("aZikt"),D=r("hHMPk"),N=r("7Qmuu");var oe=r("bgp3N"),re=(d=r("8C6BZ"),c=r("eLyRJ"),l=r("HEK4k"),L=r("lwple"),r("7eQt4")),ie=r("7Lj33"),se=(M=r("82Ilk"),P=r("9ZliH"),S=r("6rMcH"),i=r("aZikt"),d=r("8C6BZ"),{});t(se,"useFetchScannedTransaction",(function(){return pe}),(function(e){return pe=e}));i=r("aZikt"),y=r("6oEu9");var ce=r("j5GoN"),le=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((a=a.apply(e,t||[])).next())}))};const ue=new Error("Ninja API key missing");var de;!function(e){e.ChecksPassed="CHECKS_PASSED",e.KnownMalicious="KNOWN_MALICIOUS",e.SuspectedMalicious="SUSPECTED_MALICIOUS"}(de||(de={}));const pe=(e,t)=>{const[n,a]=i.useState({error:null,isLoading:!0});if(i.useEffect((()=>{le(void 0,void 0,void 0,(function*(){try{const n=new AbortController,o=n.signal;setTimeout((()=>{n.abort()}),3e3);const r=new Headers;if(void 0===y.NINJA_SECURITY_API_KEY)return void a({error:ue,isLoading:!1});r.append("X-NINJA-API-Key",y.NINJA_SECURITY_API_KEY),r.append("Content-Type","application/json");const i={transactions:e,metadata:{origin:t}},s={method:"POST",headers:r,body:JSON.stringify(i)},c=new Request("https://api.ninja.security/solana/v0/mainnet/scan/transactions",s),l=yield fetch(c,{signal:o});if(l.ok){const e=yield l.json();if(void 0===e.status||![de.ChecksPassed,de.KnownMalicious,de.SuspectedMalicious].includes(e.status))return void a({error:new Error("Response missing valid TxnScanStatus"),isLoading:!1});const t=e.status===de.KnownMalicious,n=e.status===de.SuspectedMalicious;a({error:null,isTxnKnownMalicious:t,isTxnSuspectedMalicious:n,isLoading:!1})}else a({error:new Error(`Ninja API returned non-200 response: ${l.status}`),isLoading:!1})}catch(e){e.message.toLowerCase().includes("aborted")?a({error:ce.ERR_REQUEST_TIMEOUT_REACHED,isLoading:!1}):a({error:e,isLoading:!1})}}))}),[JSON.stringify(e)]),null!==n.error&&n.error===ue)throw n.error;return n};ce=r("j5GoN"),re=r("7eQt4");var me=r("fMhDQ"),ge=(D=r("hHMPk"),i=r("aZikt"),N=r("7Qmuu"),y=r("6oEu9"),r("9qtir")),fe=(d=r("8C6BZ"),j=r("cFuyE"),l=r("HEK4k"),re=r("7eQt4"),r("lzptm")),ve=r("2t1ms"),ye=(i=r("aZikt"),r("hZalX")),he=r("ljcNr"),Te=(M=r("82Ilk"),r("jC9PB")),Ee={};t(Ee,"useFetchSimulatedTransaction",(function(){return be}),(function(e){return be=e}));re=r("7eQt4"),l=r("HEK4k"),M=r("82Ilk"),O=r("h5G75");var Ae=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((a=a.apply(e,t||[])).next())}))};function be(e,t){const{accountClient:n}=M.useSelectedAccount(),a=["simulated-tx",{messages:e}],o=!!e;return O.useQuery({queryKey:a,queryFn:()=>Ae(this,void 0,void 0,(function*(){const t=l.messagesToTransaction(e);t.recentBlockhash||(t.recentBlockhash=yield n.getLatestBlockhash()),t.feePayer||(t.feePayer=n.publicKey);const a=l.getAccountsFromTransaction(t).filter((e=>!/1111111111111111/.test(e.toString()))),o=(yield n.simulateTransaction(t,a)).value.accounts;return new Map(re.zip(a.map((e=>e.toString())),o))})),enabled:o,refetchInterval:t})}var xe=r("dkOkP").Buffer;j=r("cFuyE");var ke=r("j2x34");var Se={};t(Se,"useTokenMetasForMints",(function(){return Pe}),(function(e){return Pe=e}));var we=r("lxqKj"),Ce=r("9MFgk"),Me=(ie=r("7Lj33"),j=r("cFuyE"),fe=r("lzptm"),me=r("fMhDQ"),function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((a=a.apply(e,t||[])).next())}))});const Pe=e=>{var t;const n=fe.useFetchTokenMetas().data,a=new Map(null==n?void 0:n.map((e=>[e.address,e]))),o=null===(t=me.useFetchConnection())||void 0===t?void 0:t.data,r=null==o?void 0:o.connection;return we.useAsync((()=>Me(void 0,void 0,void 0,(function*(){var t,n,o;if(!e.length||!r)return{};const i={},s=[];for(const t of e){const e=a.get(t);e?i[t]=e:s.push(t)}if(s.length){const e=yield ie.fetchMintInfos(s,r),a=(yield Ce.fetchCollectibleMetadata(s,r)).reduce(((e,t)=>(e[t.mint.toString()]=t,e)),{});for(const r of s){const s=e[r],c=a[r];if(s){let e;c&&(e=yield Ce.fetchUriData(c.data.uri,r)),i[r]={decimals:s.decimals,address:r,symbol:null!==(t=null==c?void 0:c.data.symbol)&&void 0!==t?t:j.formatAddressShort(r),name:null!==(o=null!==(n=null==e?void 0:e.name)&&void 0!==n?n:null==c?void 0:c.data.name)&&void 0!==o?o:"Unknown",isCollectible:!!c&&!!c.data.uri}}}}return i}))),[e.length])};K=r("bJYWD"),z=r("9AO5f"),U=r("aADTv"),$=r("lSpdH");var Re=r("eopQk");D=r("hHMPk"),Q=r("g7X40");const Ie=D.default.section`
  background: #2a2a2a;
  border-radius: 6px;
  margin-bottom: 10px;
`,Be=D.default.div`
  padding-top: 0px;
  padding-bottom: 12px;
  padding-left: 18px;
  padding-right: 18px;
  border-top: 1px solid #222222;
  > * {
    margin-top: 12px;
  }
`,Oe=(D.default.div`
  padding: 12px 18px;
  display: flex;
  flex-direction: row;
  justify-content: space-between;
`,D.default(Q.Text).attrs({textAlign:"left",size:14,weight:500,lineHeight:17})``,D.default.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  > * {
    display: flex;
    align-items: center;
  }
`);Q=r("g7X40");var Fe={};t(Fe,"TransactionInstructionRows",(function(){return je}),(function(e){return je=e})),t(Fe,"SignMessageInstructionRow",(function(){return We}),(function(e){return We=e})),t(Fe,"RowCard",(function(){return Je}),(function(e){return Je=e}));D=r("hHMPk"),i=r("aZikt"),d=r("8C6BZ"),j=r("cFuyE"),M=r("82Ilk"),i=r("aZikt");Re=r("eopQk"),Q=r("g7X40");var qe=r("k7WoY"),He=r("k8hDx"),De=(ie=r("7Lj33"),me=r("fMhDQ"),r("dkOkP").Buffer),Le=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((a=a.apply(e,t||[])).next())}))};const Ne=[],je=({messages:t})=>{const{accountClient:n}=M.useSelectedAccount(),a=i.useCallback((()=>Le(void 0,void 0,void 0,(function*(){const e=(yield Promise.all(t.map((e=>n.decodeMessageAsync(e))))).filter((e=>void 0!==e));return e.flat().forEach((e=>{e&&d.analytics.capture("transactionInstructionApproval",{data:{origin:origin,type:e.type}})})),e}))),[t]),[o,r,s]=function(t,n){const[a,o]=e(i).useState({value:n,error:null,isPending:!0});e(i).useEffect((()=>{t().then((e=>o({value:e,error:null,isPending:!1}))).catch((e=>o({value:n,error:e.toString(),isPending:!1})))}),[t,n]);const{value:r,error:s,isPending:c}=a;return[r,s,c]}(a,Ne),c=o.flat();return e(i).createElement(Re.LoadingContent,{isLoading:s},c.map(((t,n)=>e(i).createElement(_e,{key:n,decodedMessage:t}))))},We=({message:t,display:n="utf8"})=>{let a;if("hex"===n)a=`0x${De.from(t).toString("hex")}`;else a=(new TextDecoder).decode(t);return e(i).createElement(Ke,null,e(i).createElement(ze,null,e(i).createElement(Q.Text,{textAlign:"left",size:14,weight:600,lineHeight:17},"Sign message"),e(i).createElement(qe.Info,{tooltipAlignment:"bottomRight",info:e(i).createElement(He.TooltipContent,{paddingLeft:10,paddingRight:10},e(i).createElement(He.TooltipText,null,"Make sure you understand what you are signing and trust the application that is requesting this."))})),e(i).createElement(Ue,null,e(i).createElement($e,null,e(i).createElement(Q.Text,{size:14,weight:500,lineHeight:17,whiteSpace:"pre-line",wordBreak:"break-all",textAlign:"left",color:"#777"},a))))},Ke=D.default.section`
  background: #2a2a2a;
  border-radius: 6px;
  margin-bottom: 10px;
`,ze=D.default.div`
  padding: 12px 18px;
  display: flex;
  flex-direction: row;
  justify-content: space-between;
`,Ue=D.default.div`
  padding-top: 0px;
  padding-bottom: 12px;
  padding-left: 18px;
  padding-right: 18px;
  border-top: 1px solid #222222;
  > * {
    margin-top: 12px;
  }
`,$e=D.default.div`
  display: flex;
  justify-content: space-between;
`,Qe=D.default.a.attrs({target:"_blank",rel:"noopener noreferrer"})`
  text-decoration: none;
  cursor: pointer;
`,Ze=({condition:e,wrapper:t,children:n})=>e?t(n):n,_e=({decodedMessage:t})=>{var n;const a=null===(n=me.useFetchConnection())||void 0===n?void 0:n.data,o=null==a?void 0:a.cluster,r=i.useMemo((()=>Ge(t)),[t]),s=i.useMemo((()=>nt(t,o)),[t,o]);return e(i).createElement(Je,{title:r,rowItems:s})},Je=({title:t,rowItems:n,emptyDescription:a,info:o})=>e(i).createElement(Ke,null,e(i).createElement(ze,null,e(i).createElement(Q.Text,{textAlign:"left",size:14,weight:500,lineHeight:17},t),o&&e(i).createElement(qe.Info,{info:o})),e(i).createElement(Ue,null,n.map((({keyText:t,valueText:n,valueColor:a,link:o})=>e(i).createElement($e,{key:t||n},t&&e(i).createElement(Q.Text,{size:14,lineHeight:17,color:"#777777"},t),e(i).createElement(Ze,{condition:o,wrapper:t=>e(i).createElement(Qe,{href:o},t)},e(i).createElement(Q.Text,{size:14,weight:500,lineHeight:17,color:a,whiteSpace:t?"normal":"pre-line",wordBreak:"break-word"},n))))),0===n.length&&e(i).createElement($e,null,e(i).createElement(Q.Text,{size:14,weight:400,lineHeight:17,whiteSpace:"normal"},a)))),Ve={cancelOrder:"Cancel order",cancelOrderV2:"Cancel order",newOrder:"Place order",newOrderV3:"Place order",settleFunds:"Settle funds",matchOrders:"Match orders",initializeMint:"Initialize mint",initializeAccount:"Initialize account",transfer:"Transfer",approve:"Approve",mintTo:"Mint to",closeAccount:"Close account",systemCreate:"Create account",systemTransfer:"Transfer SOL",createAssociatedTokenAccount:"Create token account",signMessage:"Sign Message",unknown:"Unknown"},Ge=e=>{var t;const{type:n}=e;return null!==(t=Ve[n])&&void 0!==t?t:n},Ye={side:{label:"Side",isAddress:!1},orderId:{label:"Order Id",isAddress:!1},limit:{label:"Limit",isAddress:!1},basePubkey:{label:"Base wallet",isAddress:!0},quotePubkey:{label:"Quote wallet",isAddress:!0}},Xe={amount:{label:"Amount",isAddress:!1},accountPubkey:{label:"Account",isAddress:!0},mintPubkey:{label:"Mint",isAddress:!0},sourcePubkey:{label:"Source",isAddress:!0},destinationPubkey:{label:"Destination",isAddress:!0},ownerPubkey:{label:"Owner",isAddress:!0}},et={toPubkey:{label:"To",isAddress:!0},accountPubkey:{label:"Account",isAddress:!0},basePubkey:{label:"Base",isAddress:!0},seed:{label:"Seed",isAddress:!1},noncePubkey:{label:"Nonce",isAddress:!0},authorizedPubkey:{label:"Authorized",isAddress:!0},newAuthorizedPubkey:{label:"New authorized",isAddress:!0},newAccountPubkey:{label:"New account",isAddress:!0},amount:{label:"Amount",isAddress:!1},lamports:{label:"Amount",isAddress:!1}},tt=(e,t)=>{const{market:n,marketInfo:a,data:o}=e,r=[];a&&r.push({keyText:"Market",valueText:a.name});const{side:i,limitPrice:s,maxQuantity:c,maxBaseQuantity:l,orderType:u,ownerPubkey:d}=o;r.push({keyText:"Side",valueText:i.charAt(0).toUpperCase()+i.slice(1)}),r.push({keyText:"Price",valueText:(null==n?void 0:n.priceLotsToNumber(s))||""+s});const p=t?l:c;return r.push({keyText:"Quantity",valueText:(null==n?void 0:n.baseSizeLotsToNumber(p))||""+p}),r.push({keyText:"Type",valueText:u.charAt(0).toUpperCase()+u.slice(1)}),r.push({keyText:"Owner",valueText:ot(d)}),r},nt=(e,t)=>{switch(e.type){case"cancelOrder":case"cancelOrderV2":case"matchOrders":case"settleFunds":return((e,t)=>{const n=[];return e.marketInfo&&n.push({keyText:"Market",valueText:e.marketInfo.name}),at(n,e.data,Ye,t),n})(e,t);case"closeAccount":case"initializeAccount":case"transfer":case"approve":case"mintTo":return((e,t)=>{const n=[];return at(n,e.data,Xe,t),n})(e,t);case"systemCreate":case"systemTransfer":return((e,t)=>{const n=[];return at(n,e.data,et,t),n})(e,t);case"newOrder":return tt(e,!1);case"newOrderV3":return tt(e,!0);case"unknown":case"createAssociatedTokenAccount":return((e,t)=>{const n=e.rawData,a=n.length>20?j.formatHashMedium(n,10):n,o=e.data.programId,r=t?ie.generateAddressSolscanUrl(o.toString(),t):void 0;return a?[{keyText:"Program Id",valueText:ot(o),valueColor:"#8A81F8",link:r},{keyText:"Data",valueText:a}]:[{keyText:"Program Id",valueText:ot(o),valueColor:"#8A81F8",link:r}]})(e,t);default:return[]}},at=(e,t,n,a)=>{Object.entries(t).forEach((([t,o])=>{const r=n[t];if(r){const{label:n,isAddress:i}=r,s=n;let c,l,u="";i?(u=ot(o),a&&(c=ie.generateAddressSolscanUrl(o.toString(),a),l="#8A81F8")):"lamports"===t?u=`${j.formatTokenAmount(j.lamportsToSolana(o))} SOL`:"function"==typeof o.toString()?u=o.toString():"string"==typeof o&&(u=o),e.push({keyText:s,valueText:u,valueColor:l,link:c})}}))},ot=e=>{const t=e.toString();return j.formatHashMedium(t)};He=r("k8hDx"),qe=r("k7WoY");var rt=r("2MtnF");const it=D.default(Re.LoadingContent)`
  height: 150px;
`,st=D.default(Q.Text)`
  color: ${e=>e.isKnownMalicious?ut:lt};
`,ct=D.default.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 12px 20px;
  width: 100%;
  height: 48px;
  border-width: 1px;
  border-style: solid;
  border-color: ${e=>e.isKnownMalicious?ut:lt};
  border-radius: 6px;
  margin-bottom: 10px;
`,lt="#FFDC62",ut="#EB3742",dt=({tabId:t,origin:n,messages:a,confirmApproval:o,denyApproval:r,transactionName:s,isTxnKnownMalicious:c,isTxnSuspectedMalicious:u})=>{var p;const{t:m}=N.useTranslation(),g=(()=>{const{feeCalculator:e}=ke.useBlockchainState();return j.lamportsToSolana(e.lamportsPerSignature)})()*l.getRequiredSignatures(a),[f,v]=i.useState(!1),h=fe.useFetchSolanaBalance(),T=h.data,E=fe.useFetchAssetsWithAccount(),A=E.data,b=ve.useFetchCollectibles(),x=b.data,k=i.useMemo((()=>{if(!A||!x)return re.objectArrayToMap([],"account");const e=[...A,...x];return re.objectArrayToMap(e,"account")}),[A,x]),S=!h.isFetched||!E.isFetched||!b.isFetched,w=((e,t=!1)=>{const n=Ee.useFetchSimulatedTransaction(e,t),a=n.error,{accountClient:o}=M.useSelectedAccount(),r=n.data,s=i.useMemo((()=>{const e=new Map;if(r){for(const[t,n]of r)if(n&&n.data&&n.owner.toString()===ye.TOKEN_PROGRAM_ID.toString()){const[a]=n.data;try{const n=he.deserializeTokenAccount(xe.from(a,"base64"));n.owner===o.publicKey.toString()&&e.set(t,n)}catch(e){}}return e}}),[r]);return{balances:i.useMemo((()=>{const e={};if(!r||!s)return;const t=o.publicKey.toString(),n=null==r?void 0:r.get(t);n&&(e[t]={amount:new Te.BigNumber(n.lamports)});for(const[n,a]of s)a.owner===t&&(e[n]={mint:a.mint,amount:a.amount,delegate:a.delegate});return e}),[r,s]),error:a}})(a,5e3),C=Object.values(null!==(p=w.balances)&&void 0!==p?p:{}).map((e=>e.mint)).filter((e=>!!e)),P=Se.useTokenMetasForMints(C),R=i.useMemo((()=>{var e;const{balances:t}=w;if(!t||S)return;const n=[];for(const[a,o]of Object.entries(t)){if(void 0===o.mint&&T){const e=o.amount.minus(T),t=j.lamportsToSolana(e.toNumber())+g;if(0!==t){const a=j.formatTokenAmount(Math.abs(t));n.push({keyText:y.SOLANA.symbol,valueText:e.isNegative()?`-${a} ${y.SOLANA.symbol}`:`+${a} ${y.SOLANA.symbol}`,valueColor:e.isNegative()?"#EB3742":"#21E56F"})}continue}const t=k[a],r=o.mint;if(t){const a=o.amount.minus(t.baseBalance),i=j.amountToUiAmount(a.abs(),t.decimals),s=j.formatTokenAmount(Math.abs(i));if("fungible"===t.type){const o=null!==(e=null==t?void 0:t.symbol)&&void 0!==e?e:j.formatAddressShort(null!=r?r:t.address);0!==i&&n.push({keyText:o,valueText:a.isNegative()?`-${s} ${o}`:`+${s} ${o}`,valueColor:a.isNegative()?"#EB3742":"#21E56F"})}else if("collectible"===t.type){const e="NFT";if(0!==i){const o="1"===s?"":`(${s})`;n.push({keyText:e,valueText:a.isNegative()?`-${t.name} ${o}`:`+${t.name} ${o}`})}}}else if(P.value&&r){const e=P.value[r];if(e){const t=j.amountToUiAmount(o.amount.toNumber(),e.decimals);if(0!==t){const a=j.formatTokenAmount(t),o="1"===a?"":`(${a})`;n.push({keyText:e.isCollectible?"NFT":e.symbol,valueText:e.isCollectible?`+${e.name} ${o}`:`+${a} ${e.symbol}`,valueColor:e.isCollectible?void 0:"#21E56F"})}}}}return n}),[w,k,T,g,P,S]),I=e(i).createElement(He.TooltipContent,{paddingLeft:10,paddingRight:10},e(i).createElement(He.TooltipText,null,m("notificationTransactionApprovalEstimatesBasedOnSimulations")));let B=m("notificationTransactionApprovalUnableToFetchBalanceChanges");w.error instanceof ge.TransactionSimulationError&&(B=m("notificationTransactionApprovalTransactionMayFailToConfirm"));const O=i.useMemo((()=>{const e=l.canEvadeTransactionSimulation(a);return e&&d.analytics.capture("transactionCanEvadeSimulation",{data:{messages:a.join("|")}}),e}),[a]);return O&&(B=m("notificationTransactionApprovalSignUnableToSimulate")),e(i).createElement(K.Container,null,e(i).createElement(z.AccountHeader,{firstChild:e(i).createElement("div",null),lastChild:e(i).createElement("div",null)}),e(i).createElement(K.Body,null,e(i).createElement(K.Icon,null,e(i).createElement($.TabIconHeader,{tabId:t,primaryText:s,secondaryText:j.removeWebPrefixes(n)})),e(i).createElement(it,{isLoading:void 0===R&&!w.error,showingDelayMs:0},(c||u)&&e(i).createElement(ct,{isKnownMalicious:c},e(i).createElement(st,{size:14,weight:500,lineHeight:19.6,isKnownMalicious:c},m(c?"notificationTransactionApprovalKnownMalicious":"notificationTransactionApprovalSuspectedMalicious"))),w.error||O?e(i).createElement(Fe.RowCard,{title:m("notificationTransactionApprovalEstimatedBalanceChanges"),rowItems:[{valueText:B,valueColor:ut}],info:I}):e(i).createElement(Fe.RowCard,{title:m("notificationTransactionApprovalEstimatedBalanceChanges"),rowItems:R,emptyDescription:m("notificationTransactionApprovalNoBalanceChanges"),info:I}),e(i).createElement(Ie,null,e(i).createElement(Be,null,e(i).createElement(Oe,null,e(i).createElement(Q.Text,{size:14,lineHeight:17,textAlign:"left",color:"#777",style:{gap:10,marginLeft:"-8px"}},e(i).createElement(qe.Info,{info:e(i).createElement(He.TooltipContent,{paddingLeft:10,paddingRight:10},e(i).createElement(He.TooltipText,null,m("notificationTransactionApprovalSolanaAmountRequired")))}),m("notificationTransactionApprovalNetworkFee")),e(i).createElement(Q.Text,{size:14,weight:500,lineHeight:17,whiteSpace:"normal",wordBreak:"break-word"},e(i).createElement(rt.SolBalance,null,g))))),e(i).createElement(Q.Text,{size:14,lineHeight:19,color:"#777777",margin:"17px 0",onClick:()=>v(!f)},m(f?"notificationTransactionApprovalHideAdvancedDetails":"notificationTransactionApprovalViewAdvancedDetails")),f&&e(i).createElement(Fe.TransactionInstructionRows,{messages:a}))),e(i).createElement(K.Footer,null,e(i).createElement(U.ButtonPair,{primaryText:m("notificationTransactionApprovalActionButtonApprove"),secondaryText:m("notificationTransactionApprovalActionButtonCancel"),onPrimaryClicked:o,onSecondaryClicked:r})))};var pt=r("djb9u");K=r("bJYWD"),i=r("aZikt"),D=r("hHMPk"),N=r("7Qmuu"),j=r("cFuyE"),z=r("9AO5f"),$=r("lSpdH"),U=r("aADTv"),Q=r("g7X40"),K=r("bJYWD");const mt=D.default.div`
  width: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
`,gt=D.default.div`
  border: 1px solid ${"#eb3742"};
  border-radius: 8px;
  padding: 10px 10px;
  margin-bottom: 10px;
`,ft=({tabId:t,origin:n,proceedToApproval:a,denyApproval:o})=>{const{t:r}=N.useTranslation();return e(i).createElement(K.Container,null,e(i).createElement(z.AccountHeader,{lastChild:e(i).createElement("div",null),walletMenuShowOnlyAccounts:!0}),e(i).createElement(K.Body,null,e(i).createElement(K.TopGroup,null,e(i).createElement($.TabIconHeader,{tabId:t,secondaryText:j.removeWebPrefixes(n),showWarning:!0})),e(i).createElement(mt,null,e(i).createElement(gt,null,e(i).createElement(Q.Text,{size:14,color:"#eb3742"},r("maliciousTransactionWarning"))),e(i).createElement(Q.Text,{size:14,color:"#777777",hoverColor:"#eb3742",onClick:()=>a(n)},r("maliciousTransactionWarningIgnoreWarning")))),e(i).createElement(K.Footer,{plain:!0},e(i).createElement(U.Button,{onClick:()=>o(n)},r("maliciousTransactionWarningButtonClose"))))};ee=r("lPkGw"),C=r("ixd3d");var vt=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((a=a.apply(e,t||[])).next())}))};const yt=D.default.div`
  display: flex;
  flex-direction: column;
  height: 100%;
  justify-content: center;
  align-items: center;
`,ht=({origin:t,requestId:n,requestMethod:a,tabId:o,unsignedTransactionMessages:r=[],unsignedTransactions:s=[],signAndSendSignatures:u=[],options:p={}})=>{var m;const{t:g}=N.useTranslation(),[v,y]=i.useState(!1),{isTxSubmissionServiceEnabled:h}=C.useFeatureFlags(),T=P.useTransactionsManager(),E=f.usePostOutgoingBackgroundResponse(),{accountClient:A,accountMeta:b}=M.useSelectedAccount(),x=b.type===L.AccountType.Ledger,k=a===c.ProviderToWalletRequestMethods.SignTransaction,w=a===c.ProviderToWalletRequestMethods.SignAllTransactions,R=a===c.ProviderToWalletRequestMethods.SignAndSendTransaction,I=null===(m=me.useFetchConnection())||void 0===m?void 0:m.data,B=null==I?void 0:I.connection,{pushDetailView:O,popDetailView:F}=S.useDetailViews(),q=l.canEvadeTransactionSimulation(r);let H=A;const D=H.publicKey.toString(),{isTxnKnownMalicious:j,isTxnSuspectedMalicious:W,isLoading:z}=((e,t)=>{const n=re.getOrigin(t)||"",a=se.useFetchScannedTransaction(e,n);return i.useEffect((()=>{null!==a.error&&a.error===ce.ERR_REQUEST_TIMEOUT_REACHED?d.analytics.capture("scanTransactionRequestTimeoutReached",{data:{origin:n}}):null!==a.error&&d.analytics.capture("scanTransactionRequestError",{data:{origin:n,error:a.error.message}})}),[a,n]),a})(s,t),U=i.useCallback((a=>vt(void 0,void 0,void 0,(function*(){let o;if(x){if(!B)return;const e=ie.createSignerFromLedgerAccountMeta(b,a);H=new oe.AccountClient(B,e,h,T)}try{if(R){const e=l.messageAndSignaturesToTransaction(r[0],u),a=yield H.signAndSendTransactionAsync(e,p);d.analytics.capture("signAndSendTransaction",{data:{origin:t}}),o=c.createSignSuccessResponse(n,a,D)}else{const e=[];for(const t of r)e.push(yield H.signMessageAsync(t));k?(d.analytics.capture("signTransaction",{data:{origin:t}}),o=c.createSignSuccessResponse(n,e[0],D)):w&&(d.analytics.capture("signAllTransactions",{data:{origin:t}}),o=c.createSignAllTransactionsSuccessResponse(n,e,D))}d.analytics.capture("transactionConfirm",{data:{origin:re.getOrigin(t),canEvadeSimulation:q}}),E(o)}catch(t){console.error(t),pt.isKnownLedgerActionError(t)?O(e(i).createElement(K.LedgerWrapper,null,e(i).createElement(pt.LedgerActionError,{ledgerActionError:t,onRetryClick:()=>{F()},onCancelClick:()=>{o=c.createJsonRpcErrorResponse(n,c.RpcErrorCode.UserRejectedRequest),E(o)}}))):x?(o=c.createJsonRpcErrorResponse(n,c.RpcErrorCode.UserRejectedRequest),E(o)):(o=c.createJsonRpcErrorResponse(n,c.RpcErrorCode.TransactionRejected,null==t?void 0:t.message),E(o))}}))),[n,r,A,B,E,t,q]),$=i.useCallback((()=>{x?O(e(i).createElement(K.LedgerWrapper,null,e(i).createElement(pt.LedgerAction,{ledgerAction:U,cancel:Z})),{shouldShowBackButton:!1}):U()}),[U,s,t,D,q]),Q=i.useCallback((()=>{d.analytics.capture("userIgnoredKnownMaliciousWarning",{data:{origin:re.getOrigin(t)}}),y(!0)}),[t]),Z=i.useCallback((()=>{const e=c.createJsonRpcErrorResponse(n,c.RpcErrorCode.UserRejectedRequest);d.analytics.capture("transactionDeny",{data:{origin:re.getOrigin(t),canEvadeSimulation:q}}),E(e)}),[n,E,t,q]);return z?e(i).createElement(yt,null,e(i).createElement(ee.Spinner,null)):j&&!v?e(i).createElement(ft,{tabId:o,origin:t,proceedToApproval:Q,denyApproval:Z}):e(i).createElement(dt,{tabId:o,origin:t,messages:r,confirmApproval:$,denyApproval:Z,transactionName:g("notificationSignatureRequestApproveTransactionCapitalized"),isTxnKnownMalicious:j,isTxnSuspectedMalicious:W})};var Tt={};t(Tt,"SignMessageRequest",(function(){return bt}),(function(e){return bt=e}));i=r("aZikt"),d=r("8C6BZ"),c=r("eLyRJ"),L=r("lwple"),j=r("cFuyE"),M=r("82Ilk"),S=r("6rMcH"),me=r("fMhDQ"),pt=r("djb9u"),U=r("aADTv"),z=r("9AO5f"),K=r("bJYWD"),$=r("lSpdH");var Et=r("dkOkP").Buffer,At=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((a=a.apply(e,t||[])).next())}))};const bt=t=>{var n;const{origin:a,requestId:o,message:r,display:s,tabId:l}=t,u=f.usePostOutgoingBackgroundResponse(),{accountClient:p,accountMeta:m}=M.useSelectedAccount(),g=null===(n=me.useFetchConnection())||void 0===n?void 0:n.data,v=null==g?void 0:g.connection,{pushDetailView:y}=S.useDetailViews(),h=i.useCallback((()=>At(void 0,void 0,void 0,(function*(){const e=p;try{const t=yield e.signUTF8(Et.from(r).toString()),n=e.publicKey.toString(),i=c.createSignSuccessResponse(o,t,n);d.analytics.capture("signMessageConfirm",{data:{origin:a}}),u(i)}catch(e){E()}}))),[o,r,p,v,u]),T=i.useCallback((()=>{m.type===L.AccountType.Ledger?y(e(i).createElement(K.LedgerWrapper,null,e(i).createElement(pt.LedgerAction,{ledgerAction:h,cancel:E})),{shouldShowBackButton:!1}):h()}),[h]),E=i.useCallback((()=>{const e=c.createJsonRpcErrorResponse(o,c.RpcErrorCode.UserRejectedRequest);d.analytics.capture("transactionDeny",{data:{origin:a}}),u(e)}),[o,u]);return e(i).createElement(K.Container,null,e(i).createElement(z.AccountHeader,{firstChild:e(i).createElement("div",null),lastChild:e(i).createElement("div",null)}),e(i).createElement(K.Body,null,e(i).createElement(K.Icon,null,e(i).createElement($.TabIconHeader,{tabId:l,primaryText:"Signature Request",secondaryText:j.removeWebPrefixes(a)})),e(i).createElement(Fe.SignMessageInstructionRow,{message:r,display:s})),e(i).createElement(K.Footer,null,e(i).createElement(U.ButtonPair,{primaryText:"Approve",secondaryText:"Cancel",onPrimaryClicked:T,onSecondaryClicked:E})))};var xt=r("i2Zy4");u.initSentry();const kt=()=>{const t=f.useIncomingBackgroundRequest();if(!t)return null;const{origin:n,req:a,tabId:o}=t,{id:r,method:s}=a,{message:u,messages:p,transaction:m,transactions:g,display:v,options:y}=a.params,h=m?l.transactionStringToMessageString(m):u,T=g?g.map((e=>l.transactionStringToMessageString(e))):p,E=s===c.ProviderToWalletRequestMethods.Connect,A=s===c.ProviderToWalletRequestMethods.SignMessage,b=s===c.ProviderToWalletRequestMethods.SignTransaction,x=s===c.ProviderToWalletRequestMethods.SignAllTransactions,k=s===c.ProviderToWalletRequestMethods.SignAndSendTransaction,w=b||x,C=h instanceof Uint8Array?h:c.objectToUint8Array(null!=h?h:{}),M=b||k?[h]:x?T:void 0,P=b||k?[u?l.messageStringToTransactionString(u):m]:x?p?p.map((e=>l.messageStringToTransactionString(e))):g:void 0,R=k&&m?l.transactionStringToTransaction(m,"bs58").signatures:void 0,I=E?"Connection Error":"Transaction Error",B=`There was an error attempting to ${E?"connect to the application":"sign the transaction"}. Please try again.`;return i.useEffect((()=>{d.analytics.capture("notificationOpen",{data:{method:s}})}),[s]),e(i).createElement(xt.PopupAndNotificationErrorBoundary,{title:I,message:B},E?e(i).createElement(ne,{tabId:o,origin:n,requestId:r}):A?e(i).createElement(S.DetailViewsProvider,null,e(i).createElement(Tt.SignMessageRequest,{tabId:o,origin:n,requestId:r,message:C,display:v})):w?e(i).createElement(S.DetailViewsProvider,null,e(i).createElement(ae.SignatureRequest,{tabId:o,origin:n,requestId:r,requestMethod:s,unsignedTransactionMessages:M,unsignedTransactions:P})):k?e(i).createElement(S.DetailViewsProvider,null,e(i).createElement(ae.SignatureRequest,{tabId:o,origin:n,requestId:r,requestMethod:s,unsignedTransactionMessages:M,unsignedTransactions:P,signAndSendSignatures:R,options:y})):null)},St=()=>{const t=i.useCallback((t=>e(i).createElement(B.ModalsProvider,null,e(i).createElement(I.WalletMenuProvider,null,e(i).createElement(q.Unlock,{unlockSeedAndMnemonic:t})))),[]),n=i.useCallback((()=>{m.openTabAsync({url:"onboarding.html"}),window.close()}),[]);return e(i).createElement(e(i).Fragment,null,e(i).createElement(p.ThemedGlobalStyle,{backgroundColor:"#222222"}),e(i).createElement(xt.PopupAndNotificationErrorBoundary,null,e(i).createElement(F.Main,null,e(i).createElement(C.FeatureFlagsProvider,null,e(i).createElement(O.QueryProvider,null,e(i).createElement(f.BackgroundConnectionProvider,null,e(i).createElement(w.SeedProvider,{renderLocked:t,openOnboarding:n},e(i).createElement(P.TransactionsProvider,null,e(i).createElement(R.HardwareWalletProvider,null,e(i).createElement(M.AccountsProvider,null,e(i).createElement(I.WalletMenuProvider,null,e(i).createElement(kt,null))))))))),e(i).createElement("div",{id:g.MODAL_ID}))))};s.render(e(i).createElement(St,null),document.getElementById("root"));define=__define;})(window.define);