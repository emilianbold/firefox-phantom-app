(function(define){var __define;"function"==typeof define&&define.amd&&(__define=define,define=null);
function e(e){return e&&e.__esModule?e.default:e}function t(e,t,n,a){Object.defineProperty(e,t,{get:n,set:a,enumerable:!0,configurable:!0})}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},o={},r=n.parcelRequirea886;null==r&&((r=function(e){if(e in a)return a[e].exports;if(e in o){var t=o[e];delete o[e];var n={id:e,exports:{}};return a[e]=n,t.call(n.exports,n,n.exports),n.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){o[e]=t},n.parcelRequirea886=r);var i=r("aZikt"),s=r("ihAua"),c=r("eLyRJ"),l=r("HEK4k"),u=r("6SQSC"),d=r("2WP7v"),p=r("1DdzG"),m=r("7OhhO");r("5dL5p");var g={};t(g,"BackgroundConnectionProvider",(function(){return T}),(function(e){return T=e})),t(g,"useIncomingBackgroundRequest",(function(){return x}),(function(e){return x=e})),t(g,"usePostOutgoingBackgroundResponse",(function(){return b}),(function(e){return b=e}));i=r("aZikt");var f=r("e5x4G"),v=r("6oEu9"),y=(p=r("1DdzG"),function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((a=a.apply(e,t||[])).next())}))});const h={isConnected:!1,lastMessage:null,postMessage:v.NOOP},E=e(i).createContext(h),T=({children:t})=>{const[n,a,o]=function(){const[e,t]=i.useState(null),[n,a]=i.useState(null);i.useEffect((()=>{let e;return(()=>y(this,void 0,void 0,(function*(){const n=`notification/${(yield p.getCurrentWindowAsync()).id}`;e=f.browser.runtime.connect({name:n}),t(e),e.onMessage.addListener((e=>{a(e)})),e.onDisconnect.addListener((()=>{t(null)}))})))(),()=>{null==e||e.disconnect()}}),[]);const o=i.useCallback((t=>{e&&e.postMessage(t)}),[e]);return[!!e,n,o]}();return e(i).createElement(E.Provider,{value:{isConnected:n,lastMessage:a,postMessage:o}},t)};function A(){const e=i.useContext(E);if(!e)throw new Error("Missing background connection context");return e}function x(){const{lastMessage:e}=A();return e&&"string"==typeof e.origin&&e.origin&&e.req&&"string"==typeof e.req.method&&e.req.method?e:null}function b(){const e=x(),{postMessage:t}=A();return i.useCallback((n=>{if(!e)throw new Error("No request received from the background yet");if(e.req.id!==n.id)throw new Error(`Request id: ${e.req.id} does not match response id: ${n.id}`);t(n)}),[e,t])}var w=r("cNv5c"),S=r("HyeVU"),k=r("9R0of"),C=r("fGPQl"),M=r("2R5r6"),P=r("16KRF"),R=r("jhy6c"),I=r("dgKOx"),O=r("kHEYY"),B=r("cjUNA"),F=(i=r("aZikt"),r("hHMPk")),H=r("41J1p"),q=r("lwple"),L=(c=r("eLyRJ"),S=r("HyeVU"),i=r("aZikt"),F=r("hHMPk"),r("ltHDB")),N=r("cFuyE"),j=r("awYjP"),D=r("h7pEd"),K=r("8sCMi"),U=r("8xzWM"),z=r("lFcxH"),W=r("kaQO6");const $=F.default.div`
  border-top: 1px solid #333333;
  border-bottom: 1px solid #333333;
  width: 100%;
  display: flex;
  padding: 10px 5px;
`,V=F.default.div`
  > * {
    margin: 18px 0px;
  }
`,_=F.default.div`
  display: flex;
  flex-direction: row;
  align-items: center;
  > * {
    margin: 0px ${e=>e.spacing}px;
    text-align: left;
  }
`,J=({tabId:t,origin:n,confirmApproval:a,denyApproval:o})=>{const{t:r}=L.useTranslation();return e(i).createElement(D.Container,null,e(i).createElement(K.AccountHeader,{lastChild:e(i).createElement("div",null),walletMenuShowOnlyAccounts:!0}),e(i).createElement(D.Body,null,e(i).createElement(D.TopGroup,null,e(i).createElement(z.TabIconHeader,{tabId:t,secondaryText:N.removeWebPrefixes(n)})),e(i).createElement($,null,e(i).createElement(V,null,e(i).createElement(_,{spacing:8},e(i).createElement(W.Text,{size:14,color:"#777777",lineHeight:16.94,weight:500},r("notificationApplicationApprovalPermissionsPrimary"))),e(i).createElement(_,{spacing:8},e(i).createElement(j.CheckmarkIcon,{fill:"#21E56F"}),e(i).createElement(W.Text,{size:14,lineHeight:17},r("notificationApplicationApprovalPermissionsViewWalletActivity"))),e(i).createElement(_,{spacing:8},e(i).createElement(j.CheckmarkIcon,{fill:"#21E56F"}),e(i).createElement(W.Text,{size:14,lineHeight:17},r("notificationApplicationApprovalPermissionsTransactionApproval"))))),e(i).createElement(D.BottomGroup,null,e(i).createElement(_,{spacing:4},e(i).createElement(W.Text,{size:14,lineHeight:17,color:"#777"},r("notificationApplicationApprovalConnectDisclaimer"))))),e(i).createElement(D.Footer,{plain:!0},e(i).createElement(U.ButtonPair,{primaryText:r("notificationApplicationApprovalActionButtonConnect"),secondaryText:r("notificationApplicationApprovalActionButtonCancel"),onPrimaryClicked:()=>a(n),onSecondaryClicked:()=>o(n)})))};var G=r("g9tZv"),Q=r("3SLht"),Z=r("9OxTN"),Y=r("45nY7");const X=F.default.div`
  display: flex;
  flex-direction: column;
  height: 100%;
  justify-content: center;
  align-items: center;
`,ee=({tabId:t,origin:n,requestId:a})=>{var o;const{accountClient:r}=S.useSelectedSolanaAccount(),s=r.publicKey.toString(),l=g.usePostOutgoingBackgroundResponse(),[u,d,p]=G.useStorage(q.StorageKeys.TrustedApplicationsByOwnerBrowser,{}),m=null!==(o=u[s])&&void 0!==o?o:{},f=void 0!==m[n],[v,y]=e(i).useState(!1),[h,E]=e(i).useState(!1),T=t=>{const n=e(B)(m);n[t]=!0,H.analytics.capture("connectionConfirm",{data:{origin:t}}),p(Object.assign(Object.assign({},u),{[s]:n}))},A=()=>{H.analytics.capture("connectionDeny",{data:{origin:n}});const e=c.createJsonRpcErrorResponse(a,c.RpcErrorCode.UserRejectedRequest);l(e)};if(i.useEffect((()=>{f?(()=>{const e={publicKey:s},t=c.createJsonRpcResponse(a,e);l(t)})():Z.detectPhishing(n).then((e=>{E(e.result),y(!0)})).catch((()=>{y(!0)}))}),[f]),f)return null;return d||!v?e(i).createElement(X,null,e(i).createElement(Y.Spinner,null)):h?e(i).createElement(Q.BlocklistConnectRequest,{tabId:t,origin:n,confirmApproval:T,denyApproval:A}):e(i).createElement(J,{tabId:t,origin:n,confirmApproval:T,denyApproval:A})};var te={};t(te,"SignatureRequest",(function(){return ht}),(function(e){return ht=e}));i=r("aZikt"),F=r("hHMPk"),L=r("ltHDB");var ne=r("hIiv4"),ae=(H=r("41J1p"),c=r("eLyRJ"),l=r("HEK4k"),q=r("lwple"),r("f8jMK")),oe=r("7Lj33"),re=(S=r("HyeVU"),k=r("9R0of"),w=r("cNv5c"),i=r("aZikt"),H=r("41J1p"),{});t(re,"useFetchScannedTransaction",(function(){return ue}),(function(e){return ue=e}));i=r("aZikt"),v=r("6oEu9");var ie=r("j5GoN"),se=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((a=a.apply(e,t||[])).next())}))};const ce=new Error("Ninja API key missing");var le;!function(e){e.ChecksPassed="CHECKS_PASSED",e.KnownMalicious="KNOWN_MALICIOUS",e.SuspectedMalicious="SUSPECTED_MALICIOUS"}(le||(le={}));const ue=(e,t)=>{const[n,a]=i.useState({error:null,isLoading:!0});if(i.useEffect((()=>{se(void 0,void 0,void 0,(function*(){try{const n=new AbortController,o=n.signal;setTimeout((()=>{n.abort()}),3e3);const r=new Headers;if(void 0===v.NINJA_SECURITY_API_KEY)return void a({error:ce,isLoading:!1});r.append("X-NINJA-API-Key",v.NINJA_SECURITY_API_KEY),r.append("Content-Type","application/json");const i={transactions:e,metadata:{origin:t}},s={method:"POST",headers:r,body:JSON.stringify(i)},c=new Request("https://api.ninja.security/solana/v0/mainnet/scan/transactions",s),l=yield fetch(c,{signal:o});if(l.ok){const e=yield l.json();if(void 0===e.status||![le.ChecksPassed,le.KnownMalicious,le.SuspectedMalicious].includes(e.status))return void a({error:new Error("Response missing valid TxnScanStatus"),isLoading:!1});const t=e.status===le.KnownMalicious,n=e.status===le.SuspectedMalicious;a({error:null,isTxnKnownMalicious:t,isTxnSuspectedMalicious:n,isLoading:!1})}else a({error:new Error(`Ninja API returned non-200 response: ${l.status}`),isLoading:!1})}catch(e){e.message.toLowerCase().includes("aborted")?a({error:ie.ERR_REQUEST_TIMEOUT_REACHED,isLoading:!1}):a({error:e,isLoading:!1})}}))}),[JSON.stringify(e)]),null!==n.error&&n.error===ce)throw n.error;return n};ie=r("j5GoN"),ae=r("f8jMK");var de=r("bBAGA"),pe=(F=r("hHMPk"),i=r("aZikt"),L=r("ltHDB"),v=r("6oEu9"),r("2tvQ3")),me=(H=r("41J1p"),N=r("cFuyE"),l=r("HEK4k"),ae=r("f8jMK"),r("b32BY")),ge=r("3KHBf"),fe=(i=r("aZikt"),r("hZalX")),ve=r("ljcNr"),ye=(S=r("HyeVU"),r("jC9PB")),he={};t(he,"useFetchSimulatedTransaction",(function(){return Te}),(function(e){return Te=e}));ae=r("f8jMK"),l=r("HEK4k"),S=r("HyeVU"),R=r("jhy6c");var Ee=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((a=a.apply(e,t||[])).next())}))};function Te(e,t){const{accountClient:n}=S.useSelectedSolanaAccount(),a=["simulated-tx",{messages:e}],o=!!e;return R.useQuery({queryKey:a,queryFn:()=>Ee(this,void 0,void 0,(function*(){const t=l.messagesToTransaction(e);t.recentBlockhash||(t.recentBlockhash=yield n.getLatestBlockhash()),t.feePayer||(t.feePayer=n.publicKey);const a=l.getAccountsFromTransaction(t).filter((e=>!/1111111111111111/.test(e.toString()))),o=(yield n.simulateTransaction(t,a)).value.accounts;return new Map(ae.zip(a.map((e=>e.toString())),o))})),enabled:o,refetchInterval:t})}var Ae=r("dkOkP").Buffer;var xe=r("345ql"),be={};t(be,"useTokenMetasForMints",(function(){return Ce}),(function(e){return Ce=e}));var we=r("lxqKj"),Se=r("9MFgk"),ke=(oe=r("7Lj33"),N=r("cFuyE"),me=r("b32BY"),de=r("bBAGA"),function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((a=a.apply(e,t||[])).next())}))});const Ce=e=>{var t;const n=me.useFetchTokenMetas().data,a=new Map(null==n?void 0:n.map((e=>[e.address,e]))),o=null===(t=de.useFetchConnection())||void 0===t?void 0:t.data,r=null==o?void 0:o.connection;return we.useAsync((()=>ke(void 0,void 0,void 0,(function*(){var t,n,o;if(!e.length||!r)return{};const i={},s=[];for(const t of e){const e=a.get(t);e?i[t]=e:s.push(t)}if(s.length){const e=yield oe.fetchMintInfos(s,r),a=(yield Se.fetchCollectibleMetadata(s,r)).reduce(((e,t)=>(e[t.mint.toString()]=t,e)),{});for(const r of s){const s=e[r],c=a[r];if(s){let e;c&&(e=yield Se.fetchUriData(c.data.uri,r)),i[r]={decimals:s.decimals,address:r,symbol:null!==(t=null==c?void 0:c.data.symbol)&&void 0!==t?t:N.formatAddressShort(r),name:null!==(o=null!==(n=null==e?void 0:e.name)&&void 0!==n?n:null==c?void 0:c.data.name)&&void 0!==o?o:"Unknown",isCollectible:!!c&&!!c.data.uri}}}}return i}))),[e.length])};D=r("h7pEd"),K=r("8sCMi"),U=r("8xzWM"),z=r("lFcxH");var Me=r("7KDpr");F=r("hHMPk"),W=r("kaQO6");const Pe=F.default.section`
  background: #2a2a2a;
  border-radius: 6px;
  margin-bottom: 10px;
`,Re=F.default.div`
  padding-top: 0px;
  padding-bottom: 12px;
  padding-left: 18px;
  padding-right: 18px;
  border-top: 1px solid #222222;
  > * {
    margin-top: 12px;
  }
`,Ie=(F.default.div`
  padding: 12px 18px;
  display: flex;
  flex-direction: row;
  justify-content: space-between;
`,F.default(W.Text).attrs({textAlign:"left",size:14,weight:500,lineHeight:17})``,F.default.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  > * {
    display: flex;
    align-items: center;
  }
`);W=r("kaQO6");var Oe={};t(Oe,"TransactionInstructionRows",(function(){return je}),(function(e){return je=e})),t(Oe,"SignMessageInstructionRow",(function(){return De}),(function(e){return De=e})),t(Oe,"RowCard",(function(){return Je}),(function(e){return Je=e}));F=r("hHMPk"),i=r("aZikt"),H=r("41J1p"),N=r("cFuyE"),S=r("HyeVU"),i=r("aZikt");Me=r("7KDpr"),W=r("kaQO6");var Be=r("eg2w4"),Fe=r("5M7QO"),He=(oe=r("7Lj33"),de=r("bBAGA"),r("2yhRe")),qe=r("dkOkP").Buffer,Le=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((a=a.apply(e,t||[])).next())}))};const Ne=[],je=({messages:t})=>{const{accountClient:n}=S.useSelectedSolanaAccount(),a=i.useCallback((()=>Le(void 0,void 0,void 0,(function*(){const e=(yield Promise.all(t.map((e=>n.decodeMessageAsync(e))))).filter((e=>void 0!==e));return e.flat().forEach((e=>{e&&H.analytics.capture("transactionInstructionApproval",{data:{origin:origin,type:e.type}})})),e}))),[t]),[o,r,s]=function(t,n){const[a,o]=e(i).useState({value:n,error:null,isPending:!0});e(i).useEffect((()=>{t().then((e=>o({value:e,error:null,isPending:!1}))).catch((e=>o({value:n,error:e.toString(),isPending:!1})))}),[t,n]);const{value:r,error:s,isPending:c}=a;return[r,s,c]}(a,Ne),c=o.flat();return e(i).createElement(Me.LoadingContent,{isLoading:s},c.map(((t,n)=>e(i).createElement(_e,{key:n,decodedMessage:t}))))},De=({message:t,display:n="utf8"})=>{let a;if("hex"===n)a=`0x${qe.from(t).toString("hex")}`;else a=(new TextDecoder).decode(t);return e(i).createElement(Ke,null,e(i).createElement(Ue,null,e(i).createElement(W.Text,{textAlign:"left",size:14,weight:600,lineHeight:17},"Sign message"),e(i).createElement(Be.Info,{tooltipAlignment:"bottomRight",info:e(i).createElement(Fe.TooltipContent,{paddingLeft:10,paddingRight:10},e(i).createElement(Fe.TooltipText,null,"Make sure you understand what you are signing and trust the application that is requesting this."))})),e(i).createElement(ze,null,e(i).createElement(We,null,e(i).createElement(W.Text,{size:14,weight:500,lineHeight:17,whiteSpace:"pre-line",wordBreak:"break-all",textAlign:"left",color:"#777"},a))))},Ke=F.default.section`
  background: #2a2a2a;
  border-radius: 6px;
  margin-bottom: 10px;
`,Ue=F.default.div`
  padding: 12px 18px;
  display: flex;
  flex-direction: row;
  justify-content: space-between;
`,ze=F.default.div`
  padding-top: 0px;
  padding-bottom: 12px;
  padding-left: 18px;
  padding-right: 18px;
  border-top: 1px solid #222222;
  > * {
    margin-top: 12px;
  }
`,We=F.default.div`
  display: flex;
  justify-content: space-between;
`,$e=F.default.a.attrs({target:"_blank",rel:"noopener noreferrer"})`
  text-decoration: none;
  cursor: pointer;
`,Ve=({condition:e,wrapper:t,children:n})=>e?t(n):n,_e=({decodedMessage:t})=>{var n;const a=null===(n=de.useFetchConnection())||void 0===n?void 0:n.data,o=null==a?void 0:a.cluster,{preferredExplorer:r}=He.usePreferredExplorer(),s=i.useMemo((()=>Qe(t)),[t]),c=i.useMemo((()=>tt(t,r.type,o)),[t,o,r]);return e(i).createElement(Je,{title:s,rowItems:c})},Je=({title:t,rowItems:n,emptyDescription:a,info:o})=>e(i).createElement(Ke,null,e(i).createElement(Ue,null,e(i).createElement(W.Text,{textAlign:"left",size:14,weight:500,lineHeight:17},t),o&&e(i).createElement(Be.Info,{info:o})),e(i).createElement(ze,null,n.map((({keyText:t,valueText:n,valueColor:a,link:o})=>e(i).createElement(We,{key:t||n},t&&e(i).createElement(W.Text,{size:14,lineHeight:17,color:"#777777"},t),e(i).createElement(Ve,{condition:o,wrapper:t=>e(i).createElement($e,{href:o},t)},e(i).createElement(W.Text,{size:14,weight:500,lineHeight:17,color:a,whiteSpace:t?"normal":"pre-line",wordBreak:"break-word"},n))))),0===n.length&&e(i).createElement(We,null,e(i).createElement(W.Text,{size:14,weight:400,lineHeight:17,whiteSpace:"normal"},a)))),Ge={cancelOrder:"Cancel order",cancelOrderV2:"Cancel order",newOrder:"Place order",newOrderV3:"Place order",settleFunds:"Settle funds",matchOrders:"Match orders",initializeMint:"Initialize mint",initializeAccount:"Initialize account",transfer:"Transfer",approve:"Approve",mintTo:"Mint to",closeAccount:"Close account",systemCreate:"Create account",systemTransfer:"Transfer SOL",createAssociatedTokenAccount:"Create token account",signMessage:"Sign Message",unknown:"Unknown"},Qe=e=>{var t;const{type:n}=e;return null!==(t=Ge[n])&&void 0!==t?t:n},Ze={side:{label:"Side",isAddress:!1},orderId:{label:"Order Id",isAddress:!1},limit:{label:"Limit",isAddress:!1},basePubkey:{label:"Base wallet",isAddress:!0},quotePubkey:{label:"Quote wallet",isAddress:!0}},Ye={amount:{label:"Amount",isAddress:!1},accountPubkey:{label:"Account",isAddress:!0},mintPubkey:{label:"Mint",isAddress:!0},sourcePubkey:{label:"Source",isAddress:!0},destinationPubkey:{label:"Destination",isAddress:!0},ownerPubkey:{label:"Owner",isAddress:!0}},Xe={toPubkey:{label:"To",isAddress:!0},accountPubkey:{label:"Account",isAddress:!0},basePubkey:{label:"Base",isAddress:!0},seed:{label:"Seed",isAddress:!1},noncePubkey:{label:"Nonce",isAddress:!0},authorizedPubkey:{label:"Authorized",isAddress:!0},newAuthorizedPubkey:{label:"New authorized",isAddress:!0},newAccountPubkey:{label:"New account",isAddress:!0},amount:{label:"Amount",isAddress:!1},lamports:{label:"Amount",isAddress:!1}},et=(e,t)=>{const{market:n,marketInfo:a,data:o}=e,r=[];a&&r.push({keyText:"Market",valueText:a.name});const{side:i,limitPrice:s,maxQuantity:c,maxBaseQuantity:l,orderType:u,ownerPubkey:d}=o;r.push({keyText:"Side",valueText:i.charAt(0).toUpperCase()+i.slice(1)}),r.push({keyText:"Price",valueText:(null==n?void 0:n.priceLotsToNumber(s))||""+s});const p=t?l:c;return r.push({keyText:"Quantity",valueText:(null==n?void 0:n.baseSizeLotsToNumber(p))||""+p}),r.push({keyText:"Type",valueText:u.charAt(0).toUpperCase()+u.slice(1)}),r.push({keyText:"Owner",valueText:at(d)}),r},tt=(e,t,n)=>{switch(e.type){case"cancelOrder":case"cancelOrderV2":case"matchOrders":case"settleFunds":return((e,t,n)=>{const a=[];return e.marketInfo&&a.push({keyText:"Market",valueText:e.marketInfo.name}),nt(a,e.data,Ze,t,n),a})(e,t,n);case"closeAccount":case"initializeAccount":case"transfer":case"approve":case"mintTo":return((e,t,n)=>{const a=[];return nt(a,e.data,Ye,t,n),a})(e,t,n);case"systemCreate":case"systemTransfer":return((e,t,n)=>{const a=[];return nt(a,e.data,Xe,t,n),a})(e,t,n);case"newOrder":return et(e,!1);case"newOrderV3":return et(e,!0);case"unknown":case"createAssociatedTokenAccount":return((e,t,n)=>{const a=e.rawData,o=a.length>20?N.formatHashMedium(a,10):a,r=e.data.programId,i=n?oe.generateAddressExplorerUrl(r.toString(),n,t):void 0;return o?[{keyText:"Program Id",valueText:at(r),valueColor:"#8A81F8",link:i},{keyText:"Data",valueText:o}]:[{keyText:"Program Id",valueText:at(r),valueColor:"#8A81F8",link:i}]})(e,t,n);default:return[]}},nt=(e,t,n,a,o)=>{Object.entries(t).forEach((([t,r])=>{const i=n[t];if(i){const{label:n,isAddress:s}=i,c=n;let l,u,d="";s?(d=at(r),o&&(l=oe.generateAddressExplorerUrl(r.toString(),o,a),u="#8A81F8")):"lamports"===t?d=`${N.formatTokenAmount(N.lamportsToSolana(Number(r)))} SOL`:"function"==typeof r.toString()?d=r.toString():"string"==typeof r&&(d=r),e.push({keyText:c,valueText:d,valueColor:u,link:l})}}))},at=e=>{const t=e.toString();return N.formatHashMedium(t)};Fe=r("5M7QO"),Be=r("eg2w4");var ot=r("hDM6n");const rt=F.default(Me.LoadingContent)`
  height: 150px;
`,it=F.default(W.Text)`
  color: ${e=>e.isKnownMalicious?lt:ct};
`,st=F.default.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 12px 20px;
  width: 100%;
  height: 48px;
  border-width: 1px;
  border-style: solid;
  border-color: ${e=>e.isKnownMalicious?lt:ct};
  border-radius: 6px;
  margin-bottom: 10px;
`,ct="#FFDC62",lt="#EB3742",ut=({tabId:t,origin:n,messages:a,confirmApproval:o,denyApproval:r,transactionName:s,isTxnKnownMalicious:c,isTxnSuspectedMalicious:u})=>{var d;const{t:p}=L.useTranslation(),m=xe.useGetNetworkFee()*l.getRequiredSignatures(a),[g,f]=i.useState(!1),y=me.useFetchSolanaBalance(),h=y.data,E=me.useFetchAssetsWithAccount(),T=E.data,A=ge.useFetchCollectibles(),x=A.data,b=i.useMemo((()=>{if(!T||!x)return ae.objectArrayToMap([],"account");const e=[...T,...x];return ae.objectArrayToMap(e,"account")}),[T,x]),w=!y.isFetched||!E.isFetched||!A.isFetched,k=((e,t=!1)=>{const n=he.useFetchSimulatedTransaction(e,t),a=n.error,{accountClient:o}=S.useSelectedSolanaAccount(),r=n.data,s=i.useMemo((()=>{const e=new Map;if(r){for(const[t,n]of r)if(n&&n.data&&n.owner.toString()===fe.TOKEN_PROGRAM_ID.toString()){const[a]=n.data;try{const n=ve.deserializeTokenAccount(Ae.from(a,"base64"));n.owner===o.publicKey.toString()&&e.set(t,n)}catch(e){}}return e}}),[r]);return{balances:i.useMemo((()=>{const e={};if(!r||!s)return;const t=o.publicKey.toString(),n=null==r?void 0:r.get(t);n&&(e[t]={amount:new ye.BigNumber(n.lamports)});for(const[n,a]of s)a.owner===t&&(e[n]={mint:a.mint,amount:a.amount,delegate:a.delegate});return e}),[r,s]),error:a}})(a,5e3),C=Object.values(null!==(d=k.balances)&&void 0!==d?d:{}).map((e=>e.mint)).filter((e=>!!e)),M=be.useTokenMetasForMints(C),P=i.useMemo((()=>{var e;const{balances:t}=k;if(!t||w)return;const n=[];for(const[a,o]of Object.entries(t)){if(void 0===o.mint&&h){const e=o.amount.minus(h),t=N.lamportsToSolana(e.toNumber())+m;if(0!==t){const a=N.formatTokenAmount(Math.abs(t));n.push({keyText:v.SOLANA.symbol,valueText:e.isNegative()?`-${a} ${v.SOLANA.symbol}`:`+${a} ${v.SOLANA.symbol}`,valueColor:e.isNegative()?"#EB3742":"#21E56F"})}continue}const t=b[a],r=o.mint;if(t){const a=o.amount.minus(t.baseBalance),i=N.amountToUiAmount(a.abs(),t.decimals),s=N.formatTokenAmount(Math.abs(i));if("fungible"===t.type){const o=null!==(e=null==t?void 0:t.symbol)&&void 0!==e?e:N.formatAddressShort(null!=r?r:t.address);0!==i&&n.push({keyText:o,valueText:a.isNegative()?`-${s} ${o}`:`+${s} ${o}`,valueColor:a.isNegative()?"#EB3742":"#21E56F"})}else if("collectible"===t.type){const e="NFT";if(0!==i){const o="1"===s?"":`(${s})`;n.push({keyText:e,valueText:a.isNegative()?`-${t.name} ${o}`:`+${t.name} ${o}`})}}}else if(M.value&&r){const e=M.value[r];if(e){const t=N.amountToUiAmount(o.amount.toNumber(),e.decimals);if(0!==t){const a=N.formatTokenAmount(t),o="1"===a?"":`(${a})`;n.push({keyText:e.isCollectible?"NFT":e.symbol,valueText:e.isCollectible?`+${e.name} ${o}`:`+${a} ${e.symbol}`,valueColor:e.isCollectible?void 0:"#21E56F"})}}}}return n}),[k,b,h,m,M,w]),R=e(i).createElement(Fe.TooltipContent,{paddingLeft:10,paddingRight:10},e(i).createElement(Fe.TooltipText,null,p("notificationTransactionApprovalEstimatesBasedOnSimulations")));let I=p("notificationTransactionApprovalUnableToFetchBalanceChanges");k.error instanceof pe.TransactionSimulationError&&(I=p("notificationTransactionApprovalTransactionMayFailToConfirm"));const O=i.useMemo((()=>{const e=l.canEvadeTransactionSimulation(a);return e&&H.analytics.capture("transactionCanEvadeSimulation",{data:{messages:a.join("|")}}),e}),[a]);return O&&(I=p("notificationTransactionApprovalSignUnableToSimulate")),e(i).createElement(D.Container,null,e(i).createElement(K.AccountHeader,{firstChild:e(i).createElement("div",null),lastChild:e(i).createElement("div",null)}),e(i).createElement(D.Body,null,e(i).createElement(D.Icon,null,e(i).createElement(z.TabIconHeader,{tabId:t,primaryText:s,secondaryText:N.removeWebPrefixes(n)})),e(i).createElement(rt,{isLoading:void 0===P&&!k.error,showingDelayMs:0},(c||u)&&e(i).createElement(st,{isKnownMalicious:c},e(i).createElement(it,{size:14,weight:500,lineHeight:19.6,isKnownMalicious:c},p(c?"notificationTransactionApprovalKnownMalicious":"notificationTransactionApprovalSuspectedMalicious"))),k.error||O?e(i).createElement(Oe.RowCard,{title:p("notificationTransactionApprovalEstimatedBalanceChanges"),rowItems:[{valueText:I,valueColor:lt}],info:R}):e(i).createElement(Oe.RowCard,{title:p("notificationTransactionApprovalEstimatedBalanceChanges"),rowItems:P,emptyDescription:p("notificationTransactionApprovalNoBalanceChanges"),info:R}),e(i).createElement(Pe,null,e(i).createElement(Re,null,e(i).createElement(Ie,null,e(i).createElement(W.Text,{size:14,lineHeight:17,textAlign:"left",color:"#777",style:{gap:10,marginLeft:"-8px"}},e(i).createElement(Be.Info,{info:e(i).createElement(Fe.TooltipContent,{paddingLeft:10,paddingRight:10},e(i).createElement(Fe.TooltipText,null,p("notificationTransactionApprovalSolanaAmountRequired")))}),p("notificationTransactionApprovalNetworkFee")),e(i).createElement(W.Text,{size:14,weight:500,lineHeight:17,whiteSpace:"normal",wordBreak:"break-word"},e(i).createElement(ot.SolBalance,null,m))))),e(i).createElement(W.Text,{size:14,lineHeight:19,color:"#777777",margin:"17px 0",onClick:()=>f(!g)},p(g?"notificationTransactionApprovalHideAdvancedDetails":"notificationTransactionApprovalViewAdvancedDetails")),g&&e(i).createElement(Oe.TransactionInstructionRows,{messages:a}))),e(i).createElement(D.Footer,null,e(i).createElement(U.ButtonPair,{primaryText:p("notificationTransactionApprovalActionButtonApprove"),secondaryText:p("notificationTransactionApprovalActionButtonCancel"),onPrimaryClicked:o,onSecondaryClicked:r})))};var dt=r("1pVZM");D=r("h7pEd"),i=r("aZikt"),F=r("hHMPk"),L=r("ltHDB"),N=r("cFuyE"),K=r("8sCMi"),z=r("lFcxH"),U=r("8xzWM"),W=r("kaQO6"),D=r("h7pEd");const pt=F.default.div`
  width: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
`,mt=F.default.div`
  border: 1px solid ${"#eb3742"};
  border-radius: 8px;
  padding: 10px 10px;
  margin-bottom: 10px;
`,gt=({tabId:t,origin:n,proceedToApproval:a,denyApproval:o})=>{const{t:r}=L.useTranslation();return e(i).createElement(D.Container,null,e(i).createElement(K.AccountHeader,{lastChild:e(i).createElement("div",null),walletMenuShowOnlyAccounts:!0}),e(i).createElement(D.Body,null,e(i).createElement(D.TopGroup,null,e(i).createElement(z.TabIconHeader,{tabId:t,secondaryText:N.removeWebPrefixes(n),showWarning:!0})),e(i).createElement(pt,null,e(i).createElement(mt,null,e(i).createElement(W.Text,{size:14,color:"#eb3742"},r("maliciousTransactionWarning"))),e(i).createElement(W.Text,{size:14,color:"#777777",hoverColor:"#eb3742",onClick:()=>a(n)},r("maliciousTransactionWarningIgnoreWarning")))),e(i).createElement(D.Footer,{plain:!0},e(i).createElement(U.Button,{onClick:()=>o(n)},r("maliciousTransactionWarningButtonClose"))))};Y=r("45nY7");var ft=r("j1GR2"),vt=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((a=a.apply(e,t||[])).next())}))};const yt=F.default.div`
  display: flex;
  flex-direction: column;
  height: 100%;
  justify-content: center;
  align-items: center;
`,ht=({origin:t,requestId:n,requestMethod:a,tabId:o,unsignedTransactionMessages:r=[],unsignedTransactions:s=[],signAndSendSignatures:u=[],options:d={}})=>{var p;const{t:m}=L.useTranslation(),[f,v]=i.useState(!1),[y]=ft.useFeatureFlags(["tx-submission-service"]),h=k.useTransactionsManager(),E=g.usePostOutgoingBackgroundResponse(),{accountClient:T,accountMeta:A}=S.useSelectedSolanaAccount(),x=A.type===q.AccountType.Ledger,b=a===c.ProviderToWalletRequestMethods.SignTransaction,C=a===c.ProviderToWalletRequestMethods.SignAllTransactions,M=a===c.ProviderToWalletRequestMethods.SignAndSendTransaction,P=null===(p=de.useFetchConnection())||void 0===p?void 0:p.data,R=null==P?void 0:P.connection,{pushDetailView:I,popDetailView:O}=w.useDetailViews(),B=l.canEvadeTransactionSimulation(r);let F=T;const N=F.publicKey.toString(),{isTxnKnownMalicious:j,isTxnSuspectedMalicious:K,isLoading:U}=((e,t)=>{const n=ae.getOrigin(t)||"",a=re.useFetchScannedTransaction(e,n);return i.useEffect((()=>{null!==a.error&&a.error===ie.ERR_REQUEST_TIMEOUT_REACHED?H.analytics.capture("scanTransactionRequestTimeoutReached",{data:{origin:n}}):null!==a.error&&H.analytics.capture("scanTransactionRequestError",{data:{origin:n,error:a.error.message}})}),[a,n]),a})(s,t),z=i.useCallback((a=>vt(void 0,void 0,void 0,(function*(){let o;if(x){if(!R)return;const e=oe.createSignerFromLedgerAccountMeta(A,a);F=new ne.AccountClient(R,e,y,h)}try{if(M){const e=l.messageAndSignaturesToTransaction(r[0],u),a=yield F.signAndSendTransactionAsync(e,d);H.analytics.capture("signAndSendTransaction",{data:{origin:t}}),o=c.createSignSuccessResponse(n,a,N)}else{const e=[];for(const t of r)e.push(yield F.signMessageAsync(t));b?(H.analytics.capture("signTransaction",{data:{origin:t}}),o=c.createSignSuccessResponse(n,e[0],N)):C&&(H.analytics.capture("signAllTransactions",{data:{origin:t}}),o=c.createSignAllTransactionsSuccessResponse(n,e,N))}H.analytics.capture("transactionConfirm",{data:{origin:ae.getOrigin(t),canEvadeSimulation:B}}),E(o)}catch(t){console.error(t),dt.isKnownLedgerActionError(t)?I(e(i).createElement(D.LedgerWrapper,null,e(i).createElement(dt.LedgerActionError,{ledgerActionError:t,onRetryClick:()=>{O()},onCancelClick:()=>{o=c.createJsonRpcErrorResponse(n,c.RpcErrorCode.UserRejectedRequest),E(o)}}))):x?(o=c.createJsonRpcErrorResponse(n,c.RpcErrorCode.UserRejectedRequest),E(o)):(o=c.createJsonRpcErrorResponse(n,c.RpcErrorCode.TransactionRejected,null==t?void 0:t.message),E(o))}}))),[n,r,T,R,E,t,B]),W=i.useCallback((()=>{x?I(e(i).createElement(D.LedgerWrapper,null,e(i).createElement(dt.LedgerAction,{ledgerAction:z,cancel:V})),{shouldShowBackButton:!1}):z()}),[z,s,t,N,B]),$=i.useCallback((()=>{H.analytics.capture("userIgnoredKnownMaliciousWarning",{data:{origin:ae.getOrigin(t)}}),v(!0)}),[t]),V=i.useCallback((()=>{const e=c.createJsonRpcErrorResponse(n,c.RpcErrorCode.UserRejectedRequest);H.analytics.capture("transactionDeny",{data:{origin:ae.getOrigin(t),canEvadeSimulation:B}}),E(e)}),[n,E,t,B]);return U?e(i).createElement(yt,null,e(i).createElement(Y.Spinner,null)):j&&!f?e(i).createElement(gt,{tabId:o,origin:t,proceedToApproval:$,denyApproval:V}):e(i).createElement(ut,{tabId:o,origin:t,messages:r,confirmApproval:W,denyApproval:V,transactionName:m("notificationSignatureRequestApproveTransactionCapitalized"),isTxnKnownMalicious:j,isTxnSuspectedMalicious:K})};var Et={};t(Et,"SignMessageRequest",(function(){return xt}),(function(e){return xt=e}));i=r("aZikt"),H=r("41J1p"),c=r("eLyRJ"),q=r("lwple"),N=r("cFuyE"),S=r("HyeVU"),w=r("cNv5c"),de=r("bBAGA"),dt=r("1pVZM"),U=r("8xzWM"),K=r("8sCMi"),D=r("h7pEd"),z=r("lFcxH");var Tt=r("dkOkP").Buffer,At=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((a=a.apply(e,t||[])).next())}))};const xt=t=>{var n;const{origin:a,requestId:o,message:r,display:s,tabId:l}=t,u=g.usePostOutgoingBackgroundResponse(),{accountClient:d,accountMeta:p}=S.useSelectedSolanaAccount(),m=null===(n=de.useFetchConnection())||void 0===n?void 0:n.data,f=null==m?void 0:m.connection,{pushDetailView:v}=w.useDetailViews(),y=i.useCallback((()=>At(void 0,void 0,void 0,(function*(){const e=d;try{const t=yield e.signUTF8(Tt.from(r).toString()),n=e.publicKey.toString(),i=c.createSignSuccessResponse(o,t,n);H.analytics.capture("signMessageConfirm",{data:{origin:a}}),u(i)}catch(e){E()}}))),[o,r,d,f,u]),h=i.useCallback((()=>{p.type===q.AccountType.Ledger?v(e(i).createElement(D.LedgerWrapper,null,e(i).createElement(dt.LedgerAction,{ledgerAction:y,cancel:E})),{shouldShowBackButton:!1}):y()}),[y]),E=i.useCallback((()=>{const e=c.createJsonRpcErrorResponse(o,c.RpcErrorCode.UserRejectedRequest);H.analytics.capture("transactionDeny",{data:{origin:a}}),u(e)}),[o,u]);return e(i).createElement(D.Container,null,e(i).createElement(K.AccountHeader,{firstChild:e(i).createElement("div",null),lastChild:e(i).createElement("div",null)}),e(i).createElement(D.Body,null,e(i).createElement(D.Icon,null,e(i).createElement(z.TabIconHeader,{tabId:l,primaryText:"Signature Request",secondaryText:N.removeWebPrefixes(a)})),e(i).createElement(Oe.SignMessageInstructionRow,{message:r,display:s})),e(i).createElement(D.Footer,null,e(i).createElement(U.ButtonPair,{primaryText:"Approve",secondaryText:"Cancel",onPrimaryClicked:h,onSecondaryClicked:E})))};var bt=r("5y3N4"),wt=r("3jzCT"),St=r("iZDso");u.initSentry();const kt=()=>{const t=g.useIncomingBackgroundRequest();if(!t)return null;const{origin:n,req:a,tabId:o}=t,{id:r,method:s}=a,{message:u,messages:d,transaction:p,transactions:m,display:f,options:v}=a.params,y=p?l.transactionStringToMessageString(p):u,h=m?m.map((e=>l.transactionStringToMessageString(e))):d,E=s===c.ProviderToWalletRequestMethods.Connect,T=s===c.ProviderToWalletRequestMethods.SignMessage,A=s===c.ProviderToWalletRequestMethods.SignTransaction,x=s===c.ProviderToWalletRequestMethods.SignAllTransactions,b=s===c.ProviderToWalletRequestMethods.SignAndSendTransaction,S=A||x,k=y instanceof Uint8Array?y:c.objectToUint8Array(null!=y?y:{}),C=A||b?[y]:x?h:void 0,M=A||b?[u?l.messageStringToTransactionString(u):p]:x?d?d.map((e=>l.messageStringToTransactionString(e))):m:void 0,P=b&&p?l.transactionStringToTransaction(p,"bs58").signatures:void 0,R=E?"Connection Error":"Transaction Error",I=`There was an error attempting to ${E?"connect to the application":"sign the transaction"}. Please try again.`;return St.useRootGroupEffect(),St.useCaptureOpen("notificationOpen",{data:{method:s}}),e(i).createElement(bt.PopupAndNotificationErrorBoundary,{title:R,message:I},E?e(i).createElement(ee,{tabId:o,origin:n,requestId:r}):T?e(i).createElement(w.DetailViewsProvider,null,e(i).createElement(Et.SignMessageRequest,{tabId:o,origin:n,requestId:r,message:k,display:f})):S?e(i).createElement(w.DetailViewsProvider,null,e(i).createElement(te.SignatureRequest,{tabId:o,origin:n,requestId:r,requestMethod:s,unsignedTransactionMessages:C,unsignedTransactions:M})):b?e(i).createElement(w.DetailViewsProvider,null,e(i).createElement(te.SignatureRequest,{tabId:o,origin:n,requestId:r,requestMethod:s,unsignedTransactionMessages:C,unsignedTransactions:M,signAndSendSignatures:P,options:v})):null)},Ct=()=>{const t=i.useCallback((t=>e(i).createElement(P.ModalsProvider,null,e(i).createElement(M.WalletMenuProvider,null,e(i).createElement(O.Unlock,{onUnlock:t})))),[]),n=i.useCallback((()=>{p.openTabAsync({url:"onboarding.html"}),window.close()}),[]);return e(i).createElement(e(i).Fragment,null,e(i).createElement(d.ThemedGlobalStyle,{backgroundColor:"#222222"}),e(i).createElement(bt.PopupAndNotificationErrorBoundary,null,e(i).createElement(I.Main,null,e(i).createElement(R.QueryProvider,null,e(i).createElement(g.BackgroundConnectionProvider,null,e(i).createElement(wt.ExtensionLockWrapper,{renderLocked:t,openOnboarding:n},e(i).createElement(k.TransactionsProvider,null,e(i).createElement(C.HardwareWalletProvider,null,e(i).createElement(S.SolanaAccountsProvider,null,e(i).createElement(M.WalletMenuProvider,null,e(i).createElement(kt,null)))))))),e(i).createElement("div",{id:m.MODAL_ID}))))};s.render(e(i).createElement(Ct,null),document.getElementById("root"));define=__define;})(window.define);